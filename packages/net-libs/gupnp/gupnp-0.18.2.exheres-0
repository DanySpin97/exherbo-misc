# Copyright 2010 Pierre Lejeune <superheron@gmail.com>
# Distributed under the terms of the GNU General Public License v2

require gnome.org [ suffix=.tar.xz ]

SUMMARY="GUPnP is an object-oriented open source framework
for creating UPnP devices and control points, written in C
using GObject and libsoup. The GUPnP API is intended to be
easy to use, efficient and flexible."
DESCRIPTION="
The GUPnP framework consists of the following two libraries:

  * GSSDP implements resource discovery and announcement over SSDP.

  * GUPnP implements the UPnP specification: resource announcement and
    discovery, description, control, event notification, and presentation
    (GUPnP includes basic web server functionality through libsoup). GUPnP does
    not include helpers for construction or control of specific standardized
    resources (e.g. MediaServer); this is left for higher level libraries
    utilizing the GUPnP framework.

The GUPnP framework was born out of frustration with libupnp and its mess of
threads. GUPnP is entirely single-threaded (though asynchronous), integrates
with the GLib main loop, and provides the same set of features as libupnp while
hiding most of the UPnP internals through an elegant object-oriented design.

GUPnP is free software released under the GNU LGPL.
"
HOMEPAGE="http://gupnp.org/"

LICENCES="LGPL-2"
SLOT="1.0"
PLATFORMS="~amd64"
MYOPTIONS="gobject-introspection gtk-doc networkmanager"

# TODO: automagic check for conic with unix context manager
DEPENDENCIES="
    build:
        dev-util/pkg-config[>=0.9.0]
        gtk-doc? ( dev-doc/gtk-doc[>=1.0] )
    build+run:
        dev-libs/glib:2[>=2.26]
        dev-libs/libxml2:2.0
        gnome-desktop/libsoup:2.4[>=2.28.2][gobject-introspection?]
        net-libs/gssdp:1.0[>=0.11.2][gobject-introspection?]
        sys-apps/util-linux
        gobject-introspection? ( gnome-desktop/gobject-introspection:1[>=0.6.4] )
    run:
        networkmanager? ( net-apps/NetworkManager )
"

RESTRICT="test" # network violation

REMOTE_IDS="freshmeat:${PN}"

UPSTREAM_RELEASE_NOTES="http://ftp.gnome.org/pub/GNOME/sources/${PN}/$(ever range 1-2)/${PNV}.news"
UPSTREAM_DOCUMENTATION="http://developer.gnome.org/${PN}/$(ever range 1-2)"

src_configure() {
    local context_manager='linux'
    optionq networkmanager && context_manager='network-manager'
    econf $(option_enable gtk-doc) \
          $(option_enable gobject-introspection introspection) \
          --with-context-manager=${context_manager}
}

