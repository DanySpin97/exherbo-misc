Source: Written by Pierre Lejeune, and modified by Anders Ladegaard Marchsteiner, for Exherbo
Upstream: https://bugzilla.xamarin.com/show_bug.cgi?id=3650
Reason: Take libdir configure arg into account
diff -urpN a/build/Makefile.am b/build/Makefile.am
--- a/build/Makefile.am	2013-09-21 10:27:19.161386874 +0200
+++ b/build/Makefile.am	2013-09-21 10:30:16.360389293 +0200
@@ -9,11 +9,11 @@ endif
 all:
 
 install:
-	mkdir -p $(DESTDIR)$(prefix)/lib/monodevelop/bin
-	cp -rf bin $(DESTDIR)$(prefix)/lib/monodevelop/
-	cp -rf AddIns $(DESTDIR)$(prefix)/lib/monodevelop/
-	cp -rf locale $(DESTDIR)$(prefix)/lib/monodevelop/
-	cp -rf data $(DESTDIR)$(prefix)/lib/monodevelop/
+	mkdir -p $(DESTDIR)$(libdir)/monodevelop/bin
+	cp -rf bin $(DESTDIR)$(libdir)/monodevelop/
+	cp -rf AddIns $(DESTDIR)$(libdir)/monodevelop/
+	cp -rf locale $(DESTDIR)$(libdir)/monodevelop/
+	cp -rf data $(DESTDIR)$(libdir)/monodevelop/
 
 clean-local:
 	rm -rf bin AddIns locale data
diff -urpN a/build/Makefile.in b/build/Makefile.in
--- a/build/Makefile.in	2013-09-21 10:27:19.161386874 +0200
+++ b/build/Makefile.in	2013-09-21 10:31:43.332390480 +0200
@@ -588,11 +588,11 @@ uninstall-am:
 all:
 
 install:
-	mkdir -p $(DESTDIR)$(prefix)/lib/monodevelop/bin
-	cp -rf bin $(DESTDIR)$(prefix)/lib/monodevelop/
-	cp -rf AddIns $(DESTDIR)$(prefix)/lib/monodevelop/
-	cp -rf locale $(DESTDIR)$(prefix)/lib/monodevelop/
-	cp -rf data $(DESTDIR)$(prefix)/lib/monodevelop/
+	mkdir -p $(DESTDIR)$(libdir)/monodevelop/bin
+	cp -rf bin $(DESTDIR)$(libdir)/monodevelop/
+	cp -rf AddIns $(DESTDIR)$(libdir)/monodevelop/
+	cp -rf locale $(DESTDIR)$(libdr)/monodevelop/
+	cp -rf data $(DESTDIR)$(libdir)/monodevelop/
 
 clean-local:
 	rm -rf bin AddIns locale data
diff -urpN a/configure b/configure
--- a/configure	2013-09-21 10:27:21.407386904 +0200
+++ b/configure	2013-09-21 10:32:28.718391100 +0200
@@ -4094,7 +4094,7 @@ CSC_FLAGS="-debug -codepage:utf8"
 
 
 
-MD_DIR='$(prefix)/lib/monodevelop'
+MD_DIR='$(libdir)/monodevelop'
 MD_ASSEMBLY_DIR="$MD_DIR/bin"
 MD_ADDIN_DIR="$MD_DIR/AddIns"
 
diff -urpN a/configure.in b/configure.in
--- a/configure.in	2013-09-21 10:27:19.148386874 +0200
+++ b/configure.in	2013-09-21 10:32:48.630391372 +0200
@@ -258,7 +258,7 @@ AC_SUBST(SQLITE_XML)
 AC_SUBST(CSC_FLAGS)
 
 
-MD_DIR='$(prefix)/lib/monodevelop'
+MD_DIR='$(libdir)/monodevelop'
 MD_ASSEMBLY_DIR="$MD_DIR/bin"
 MD_ADDIN_DIR="$MD_DIR/AddIns"
 
diff -urpN a/external/mono-tools/asn1view/gtk/Makefile.am b/external/mono-tools/asn1view/gtk/Makefile.am
--- a/external/mono-tools/asn1view/gtk/Makefile.am	2013-09-21 10:27:19.836386883 +0200
+++ b/external/mono-tools/asn1view/gtk/Makefile.am	2013-09-21 10:33:31.187391952 +0200
@@ -30,7 +30,7 @@ gasnview_sources_build = $(gasnview_sour
 if ENABLE_GNOME
 
 gasnview_SCRIPTS = gasnview.exe
-gasnviewdir = $(prefix)/lib/mono/1.0
+gasnviewdir = $(libdir)/mono/1.0
 
 ress= $(foreach res,$(resources), $(addprefix -resource:,$(res)),$(notdir $(res)))
 
diff -urpN a/external/mono-tools/create-native-map/lib/pkgconfig/Makefile.am b/external/mono-tools/create-native-map/lib/pkgconfig/Makefile.am
--- a/external/mono-tools/create-native-map/lib/pkgconfig/Makefile.am	2013-09-21 10:27:19.979386885 +0200
+++ b/external/mono-tools/create-native-map/lib/pkgconfig/Makefile.am	2013-09-21 10:34:10.806392493 +0200
@@ -1,5 +1,5 @@
 
-pkgconfigdir = $(prefix)/lib/pkgconfig
+pkgconfigdir = $(libdir)/pkgconfig
 pkgconfig_DATA = create-native-map.pc
 
 DISTCLEANFILES = create-native-map.pc
diff -urpN a/external/mono-tools/create-native-map/src/Makefile.am b/external/mono-tools/create-native-map/src/Makefile.am
--- a/external/mono-tools/create-native-map/src/Makefile.am	2013-09-21 10:27:19.977386885 +0200
+++ b/external/mono-tools/create-native-map/src/Makefile.am	2013-09-21 10:34:42.497392926 +0200
@@ -19,7 +19,7 @@ all: $(EXE)
 $(EXE) : $(cnm_build_sources)
 	$(GMCS) $(MCS_FLAGS) -d:TRACE -debug+ -out:$@ -target:exe $(REFS) $(cnm_build_sources)
 
-assemblydir = $(prefix)/lib/create-native-map
+assemblydir = $(libdir)/create-native-map
 assembly_DATA = $(EXE) MapAttribute.cs
 
 check: $(PROGRAM) TestMap.dll
diff -urpN a/external/mono-tools/docbrowser/Makefile.am b/external/mono-tools/docbrowser/Makefile.am
--- a/external/mono-tools/docbrowser/Makefile.am	2013-09-21 10:27:20.023386886 +0200
+++ b/external/mono-tools/docbrowser/Makefile.am	2013-09-21 10:35:11.042393316 +0200
@@ -1,4 +1,4 @@
-monodocdir=$(prefix)/lib/monodoc
+monodocdir=$(libdir)/monodoc
 
 if DMCS_PRESENT
 COMPILER=$(DMCS)
diff -urpN a/external/mono-tools/gendarme/console/Makefile.am b/external/mono-tools/gendarme/console/Makefile.am
--- a/external/mono-tools/gendarme/console/Makefile.am	2013-09-21 10:27:19.954386885 +0200
+++ b/external/mono-tools/gendarme/console/Makefile.am	2013-09-21 10:36:07.656394089 +0200
@@ -1,6 +1,6 @@
 include ../options.make
 
-gendarmedir=$(prefix)/lib/gendarme
+gendarmedir=$(libdir)/gendarme
 gendarme_SCRIPTS = ../bin/gendarme.exe
 EXTRA_DIST = $(gendarme_sources) $(gendarme_sources_in) $(gendarme_resources) gendarme.csproj
 CLEANFILES = $(gendarme_SCRIPTS) $(gendarme_SCRIPTS).mdb
diff -urpN a/external/mono-tools/gendarme/framework/Makefile.am b/external/mono-tools/gendarme/framework/Makefile.am
--- a/external/mono-tools/gendarme/framework/Makefile.am	2013-09-21 10:27:19.962386885 +0200
+++ b/external/mono-tools/gendarme/framework/Makefile.am	2013-09-21 10:37:25.659395153 +0200
@@ -2,7 +2,7 @@ include ../options.make
 
 SUBDIRS = Test
 
-frameworkdir=$(prefix)/lib/gendarme
+frameworkdir=$(libdir)/gendarme
 framework_SCRIPTS = ../bin/Gendarme.Framework.dll
 EXTRA_DIST = $(framework_sources) $(framework_sources_in) $(framework_test_build_sources) \
 	Gendarme.Framework.csproj gendarme-framework.pc.in
@@ -11,14 +11,14 @@ DISTCLEANFILES = ../AssemblyInfo.cs Make
 
 pkgconfig_in_files = gendarme-framework.pc.in
 
-pkgconfigdir= $(prefix)/lib/pkgconfig
+pkgconfigdir= $(libdir)/pkgconfig
 pkgconfig_DATA = $(pkgconfig_in_files:.pc.in=.pc)
 
 framework_doc_source = doc/Gendarme.Framework.source
 framework_doc_tree = doc/Gendarme.Framework.tree
 framework_doc_zip = doc/Gendarme.Framework.zip
 
-framework_documentationdir = $(prefix)/lib/monodoc/sources
+framework_documentationdir = $(libdir)/monodoc/sources
 framework_documentation_DATA = $(framework_doc)
 
 framework_doc = $(framework_doc_zip) $(framework_doc_source) $(framework_doc_tree)
@@ -116,7 +116,7 @@ Test.Framework.dll: $(framework_test_bui
 test: Test.Framework.dll
 
 run-test: test
-	MONO_PATH=../bin/:../rules/Test.Rules/:$(MONO_PATH) $(prefix)/bin/mono $(prefix)/lib/mono/4.0/nunit-console.exe Test.Framework.dll
+	MONO_PATH=../bin/:../rules/Test.Rules/:$(MONO_PATH) $(prefix)/bin/mono $(libdir)/mono/4.0/nunit-console.exe Test.Framework.dll
 
 self-test: $(framework_SCRIPTS)
 	mono --debug ../bin/gendarme.exe $(framework_SCRIPTS)
diff -urpN a/external/mono-tools/gendarme/man/Makefile.am b/external/mono-tools/gendarme/man/Makefile.am
--- a/external/mono-tools/gendarme/man/Makefile.am	2013-09-21 10:27:19.965386885 +0200
+++ b/external/mono-tools/gendarme/man/Makefile.am	2013-09-21 10:37:44.723395414 +0200
@@ -3,7 +3,7 @@ EXTRA_DIST = gendarme.1.in gendarme.5.in
 DISTCLEANFILES = Makefile.in gendarme.1 gendarme.5 gd2i.1
 CLEANFILES = gendarme.tree gendarme.zip
 
-rules_documentationdir = $(prefix)/lib/monodoc/sources
+rules_documentationdir = $(libdir)/monodoc/sources
 rules_documentation_DATA = gendarme.source gendarme.tree gendarme.zip
 
 all: gendarme.tree gendarme.zip
diff -urpN a/external/mono-tools/gendarme/rules/common.make b/external/mono-tools/gendarme/rules/common.make
--- a/external/mono-tools/gendarme/rules/common.make	2013-09-21 10:27:19.902386884 +0200
+++ b/external/mono-tools/gendarme/rules/common.make	2013-09-21 10:38:20.546395903 +0200
@@ -18,10 +18,10 @@ rules_doc_source = doc/$(prefixed_rules_
 rules_doc_tree = doc/$(prefixed_rules_category).tree
 rules_doc_zip = doc/$(prefixed_rules_category).zip
 
-rules_categorydir = $(prefix)/lib/gendarme
+rules_categorydir = $(libdir)/gendarme
 rules_category_SCRIPTS = $(rules_dll)
 
-rules_documentationdir = $(prefix)/lib/monodoc/sources
+rules_documentationdir = $(libdir)/monodoc/sources
 rules_documentation_DATA = $(rules_doc)
 
 rules_sources_in = ../../AssemblyInfo.cs.in
@@ -54,7 +54,7 @@ test: $(tests_dll)
 
 run-test: test
 	cp ../../bin/gendarme.exe.config $(tests_dll).config
-	MONO_PATH=../../bin/:../Test.Rules/:$(MONO_PATH) $(prefix)/bin/mono $(prefix)/lib/mono/4.0/nunit-console.exe $(tests_dll)
+	MONO_PATH=../../bin/:../Test.Rules/:$(MONO_PATH) $(prefix)/bin/mono $(libdir)/mono/4.0/nunit-console.exe $(tests_dll)
 
 self-test: $(rules_dll)
 	mono --debug $(console_runner) $(rules_dll)
diff -urpN a/external/mono-tools/gendarme/rules/Makefile.am b/external/mono-tools/gendarme/rules/Makefile.am
--- a/external/mono-tools/gendarme/rules/Makefile.am	2013-09-21 10:27:19.874386884 +0200
+++ b/external/mono-tools/gendarme/rules/Makefile.am	2013-09-21 10:38:49.474396298 +0200
@@ -27,10 +27,10 @@ EXTRA_DIST = rules.xml common.make
 DISTCLEANFILES = Makefile.in
 
 install-data-hook:
-	$(INSTALL) -c -m 0644 $(addprefix $(srcdir)/, rules.xml) $(DESTDIR)$(prefix)/lib/gendarme;
+	$(INSTALL) -c -m 0644 $(addprefix $(srcdir)/, rules.xml) $(DESTDIR)$(libdir)/gendarme;
 
 uninstall-hook:
-	rm -f $(DESTDIR)$(prefix)/lib/gendarme/`basename rules.xml`;
+	rm -f $(DESTDIR)$(libdir)/gendarme/`basename rules.xml`;
  
 rules:
 	for ASM in $(RULEDIRS); do \
diff -urpN a/external/mono-tools/gendarme/swf-wizard-runner/Makefile.am b/external/mono-tools/gendarme/swf-wizard-runner/Makefile.am
--- a/external/mono-tools/gendarme/swf-wizard-runner/Makefile.am	2013-09-21 10:27:19.946386885 +0200
+++ b/external/mono-tools/gendarme/swf-wizard-runner/Makefile.am	2013-09-21 10:40:06.596397350 +0200
@@ -1,4 +1,4 @@
-wizarddir=$(prefix)/lib/gendarme
+wizarddir=$(libdir)/gendarme
 wizard_SCRIPTS = ../bin/gendarme-wizard.exe
 
 desktopdir = $(datadir)/applications
diff -urpN a/external/mono-tools/gendarme/tools/supported/gd2i/Makefile.am b/external/mono-tools/gendarme/tools/supported/gd2i/Makefile.am
--- a/external/mono-tools/gendarme/tools/supported/gd2i/Makefile.am	2013-09-21 10:27:19.950386885 +0200
+++ b/external/mono-tools/gendarme/tools/supported/gd2i/Makefile.am	2013-09-21 10:40:42.547397841 +0200
@@ -1,6 +1,6 @@
 EXTRA_DIST = $(gd2i_sources) gd2i.csproj
 
-gd2idir=$(prefix)/lib/gendarme
+gd2idir=$(libdir)/gendarme
 gd2i_SCRIPTS = ../../../bin/gd2i.exe
 CLEANFILES = $(gd2i_SCRIPTS) $(gd2i_SCRIPTS).mdb
 DISTCLEANFILES = Makefile.in
diff -urpN a/external/mono-tools/gsharp/Makefile.am b/external/mono-tools/gsharp/Makefile.am
--- a/external/mono-tools/gsharp/Makefile.am	2013-09-21 10:27:19.837386883 +0200
+++ b/external/mono-tools/gsharp/Makefile.am	2013-09-21 10:41:09.158398204 +0200
@@ -1,4 +1,4 @@
-gsharpdir = $(prefix)/lib/gsharp
+gsharpdir = $(libdir)/gsharp
 
 if DMCS_PRESENT
 COMPILER=$(DMCS)
diff -urpN a/external/mono-tools/gui-compare/gui-compare.make b/external/mono-tools/gui-compare/gui-compare.make
--- a/external/mono-tools/gui-compare/gui-compare.make	2013-09-21 10:27:20.000386885 +0200
+++ b/external/mono-tools/gui-compare/gui-compare.make	2013-09-21 10:42:53.193399625 +0200
@@ -148,17 +148,17 @@ $(ASSEMBLY) $(ASSEMBLY_MDB): $(build_sou
 
 install-local: $(ASSEMBLY) $(ASSEMBLY_MDB) $(GUI_COMPARE) $(MONO_CECIL_DLL)
 	make pre-install-local-hook prefix=$(prefix)
-	mkdir -p $(DESTDIR)$(prefix)/lib/$(PACKAGE)
-	cp $(ASSEMBLY) $(ASSEMBLY_MDB) $(DESTDIR)$(prefix)/lib/$(PACKAGE)
+	mkdir -p $(DESTDIR)$(libdir)/$(PACKAGE)
+	cp $(ASSEMBLY) $(ASSEMBLY_MDB) $(DESTDIR)$(libdir)/$(PACKAGE)
 	mkdir -p $(DESTDIR)$(prefix)/bin
 	test -z '$(GUI_COMPARE)' || cp $(GUI_COMPARE) $(DESTDIR)$(prefix)/bin
-	test -z '$(MONO_CECIL_DLL)' || cp $(MONO_CECIL_DLL) $(DESTDIR)$(prefix)/lib/$(PACKAGE)
+	test -z '$(MONO_CECIL_DLL)' || cp $(MONO_CECIL_DLL) $(DESTDIR)$(libdir)/$(PACKAGE)
 	make post-install-local-hook prefix=$(prefix)
 
 uninstall-local: $(ASSEMBLY) $(ASSEMBLY_MDB) $(GUI_COMPARE) $(MONO_CECIL_DLL)
 	make pre-uninstall-local-hook prefix=$(prefix)
-	rm -f $(DESTDIR)$(prefix)/lib/$(PACKAGE)/$(notdir $(ASSEMBLY))
-	test -z '$(ASSEMBLY_MDB)' || rm -f $(DESTDIR)$(prefix)/lib/$(PACKAGE)/$(notdir $(ASSEMBLY_MDB))
+	rm -f $(DESTDIR)$(libdir)/$(PACKAGE)/$(notdir $(ASSEMBLY))
+	test -z '$(ASSEMBLY_MDB)' || rm -f $(DESTDIR)$(libdir)/$(PACKAGE)/$(notdir $(ASSEMBLY_MDB))
 	test -z '$(GUI_COMPARE)' || rm -f $(DESTDIR)$(prefix)/bin/$(notdir $(GUI_COMPARE))
-	test -z '$(MONO_CECIL_DLL)' || rm -f $(DESTDIR)$(prefix)/lib/$(PACKAGE)/$(notdir $(MONO_CECIL_DLL))
+	test -z '$(MONO_CECIL_DLL)' || rm -f $(DESTDIR)$(libdir)/$(PACKAGE)/$(notdir $(MONO_CECIL_DLL))
 	make post-uninstall-local-hook prefix=$(prefix)
diff -urpN a/external/mono-tools/gui-compare/Makefile.am b/external/mono-tools/gui-compare/Makefile.am
--- a/external/mono-tools/gui-compare/Makefile.am	2013-09-21 10:27:20.001386885 +0200
+++ b/external/mono-tools/gui-compare/Makefile.am	2013-09-21 10:43:11.356399873 +0200
@@ -1,4 +1,4 @@
-guicomparedir=$(prefix)/lib/gui-compare
+guicomparedir=$(libdir)/gui-compare
 bin_SCRIPTS = gui-compare
 guicompare_DATA = gui-compare.exe gui-compare.exe.mdb
 
diff -urpN a/external/mono-tools/minvoke/Makefile.am b/external/mono-tools/minvoke/Makefile.am
--- a/external/mono-tools/minvoke/Makefile.am	2013-09-21 10:27:19.970386885 +0200
+++ b/external/mono-tools/minvoke/Makefile.am	2013-09-21 10:43:47.421400365 +0200
@@ -1,4 +1,4 @@
-minvokedir=$(prefix)/lib/minvoke
+minvokedir=$(libdir)/minvoke
 bin_SCRIPTS = minvoke
 minvoke_DATA = minvoke.exe
 
diff -urpN a/external/mono-tools/mperfmon/Makefile.am b/external/mono-tools/mperfmon/Makefile.am
--- a/external/mono-tools/mperfmon/Makefile.am	2013-09-21 10:27:19.972386885 +0200
+++ b/external/mono-tools/mperfmon/Makefile.am	2013-09-21 10:44:06.320400623 +0200
@@ -1,4 +1,4 @@
-mperfmondir=$(prefix)/lib/mperfmon
+mperfmondir=$(libdir)/mperfmon
 bin_SCRIPTS = mperfmon
 mperfmon_DATA = mperfmon.exe config
 man_MANS=mperfmon.1
diff -urpN a/external/mono-tools/webdoc/Makefile.am b/external/mono-tools/webdoc/Makefile.am
--- a/external/mono-tools/webdoc/Makefile.am	2013-09-21 10:27:19.998386885 +0200
+++ b/external/mono-tools/webdoc/Makefile.am	2013-09-21 10:44:27.041400906 +0200
@@ -1,4 +1,4 @@
-webdir=$(prefix)/lib/monodoc/web
+webdir=$(libdir)/monodoc/web
 
 web_DATA = \
 	Global.asax \
diff -urpN a/Makefile.am b/Makefile.am
--- a/Makefile.am	2013-09-21 10:27:19.161386874 +0200
+++ b/Makefile.am	2013-09-21 10:45:21.958401655 +0200
@@ -50,7 +50,7 @@ xdgmime_DATA = monodevelop.xml
 
 pkgconfig_in_files = monodevelop.pc.in monodevelop-core-addins.pc.in
 
-pkgconfigdir= $(prefix)/lib/pkgconfig
+pkgconfigdir= $(libdir)/pkgconfig
 pkgconfig_DATA = $(pkgconfig_in_files:.pc.in=.pc)
 
 if ENABLE_UPDATE_MIMEDB
diff -urpN a/Makefile.in b/Makefile.in
--- a/Makefile.in	2013-09-21 10:27:19.148386874 +0200
+++ b/Makefile.in	2013-09-21 10:46:00.177402177 +0200
@@ -332,7 +332,7 @@ desktop_DATA = monodevelop.desktop
 xdgmimedir = $(datadir)/mime/packages
 xdgmime_DATA = monodevelop.xml
 pkgconfig_in_files = monodevelop.pc.in monodevelop-core-addins.pc.in
-pkgconfigdir = $(prefix)/lib/pkgconfig
+pkgconfigdir = $(libdir)/pkgconfig
 pkgconfig_DATA = $(pkgconfig_in_files:.pc.in=.pc)
 PACKAGES = \
 	build/bin/MonoDevelop.Core.Gui.addin.xml \
diff -urpN a/po/Makefile b/po/Makefile
--- a/po/Makefile	2013-09-21 10:27:19.156386874 +0200
+++ b/po/Makefile	2013-09-21 10:46:44.565402783 +0200
@@ -109,9 +109,9 @@ LTLIBOBJS =
 MAINT = 
 MAKEINFO = ${SHELL} /home/builder/data/lanes/monodevelop-linux-monodevelop-4.0.12-branch/593d7acb/source/monodevelop/main/missing --run makeinfo
 MCS = /usr/bin/gmcs
-MD_ADDIN_DIR = $(prefix)/lib/monodevelop/AddIns
-MD_ASSEMBLY_DIR = $(prefix)/lib/monodevelop/bin
-MD_DIR = $(prefix)/lib/monodevelop
+MD_ADDIN_DIR = $(libdir)/monodevelop/AddIns
+MD_ASSEMBLY_DIR = $(libdir)/monodevelop/bin
+MD_DIR = $(libdir)/monodevelop
 MKDIR_P = /usr/bin/mkdir -p
 MONO = /usr/bin/mono
 MONODOC_CFLAGS =  
